const { encrypt } = require('qq-crypto')
const GetRandomFingerprint =
  process.argv[2] === 'staging'
    ? () => ({
        id: '632d70de-74a2-4a06-d26a-c84835738a64',
        canvas: {
          vals: [
            '551916805',
            '-1513287443',
            '269924009',
            '-1731745542',
            '1499930567',
            '2068959039',
            '143030725',
            '-407240033',
            '-4297918',
            '433569357',
            '-362125090',
            '-298664438',
            '2104164364',
            '1726304575',
            '-116745711',
            '-1319905047',
            '1365343395',
            '1713614940',
            '1580046294',
            '727811582',
            '1032989717',
            '61611602',
            '240966950',
            '822243237',
            '954792412',
            '-1210944170',
            '-1003041459',
            '1405941856',
            '-523719325',
            '-1463148022',
            '672534560',
            '-12620825',
            '-1107226070',
            '1413453838',
            '80981169',
            '932339193',
            '1396153769',
            '721944158',
            '1618745010',
            '968165114',
            '-2011777305',
            '1128012821',
            '-583284790',
            '-2058311955',
            '1914025893',
            '12706983',
            '-1632715377',
            '641707922',
            '1376697706',
            '741236728',
            '1319253291',
            '1220247148',
            '1032285856',
            '777188007',
            '-319895093',
            '122502211',
            '-612169390',
            '-1257117290',
            '-1597195788',
            '-797333941',
            '-1848628780',
            '1773160715',
            '389670327',
            '227513722',
            '1681408040',
            '-1917160759',
            '-429336894',
            '297912440',
            '399091996',
            '-1150910356',
            '-2093219492',
            '277344428',
            '143040101',
            '-314986050',
            '398952981',
            '2147363576',
            '1252353420',
            '967977678',
            '-726095972',
            '-1828818832',
            '-1583196266',
            '-374382153',
            '535551005',
            '986523866',
            '-1152254795',
            '1502438755',
            '-1396508886',
            '1146650430',
            '770441178',
            '-654389089',
            '-727994513',
            '1429020800',
            '1561565861',
            '837659341',
            '-2122645664',
            '-2017288238',
            '-1351409010',
            '308246106',
            '825764947',
            '405541389',
            '1844615669',
            '11401829',
            '11704433',
            '-727874207',
            '1460592805',
            '-194837427',
            '-558233453',
            '1461589950',
            '-1890307910',
            '2031334916',
            '-1011550729',
            '-1867566666',
            '278204474',
            '592751767',
            '897755062',
            '958872544',
            '852891674',
            '-285064198',
            '758775593',
            '-2091746991',
            '2108566167',
            '-360798511',
            '-997742752',
            '-675650964',
            '56741826',
            '48692676',
            '-64050088',
            '1075594321',
            '1443596421',
            '-1748565275',
            '-461459566',
            '-368326829',
            '10851583',
            '752733939',
            '-1800415062',
            '530530796',
            '-1655504151',
            '836074548',
            '-1445451057',
            '586254834',
            '-1952136177',
            '1294433252',
            '-1604325626',
            '688859606',
            '1686729180',
            '-2065449704',
            '30642540',
            '-1591083295',
            '334101559',
            '1479750502',
            '1582140416',
            '2109007104',
            '673609597',
            '484318484',
            '1025276404',
            '-1929458476',
            '-496539311',
            '1718215351',
            '915995375',
            '1057645514',
            '1879455281',
            '-253234619',
            '-2139259811',
            '-1590110101',
            '-1020828529',
            '-829507334',
            '357166302',
            '-1969606339',
            '846027306',
            '-689242323',
            '1127430617',
            '1615704310',
            '-1955210685',
            '1686002427',
            '-1187864247',
            '1222850026',
            '1749209143',
            '-833548130',
            '1463834550',
            '-1493453269',
            '2092719767',
            '2099355303',
            '553236093',
            '1689110516',
            '-246854094',
            '-913851146',
            '-431820717',
            '205452632',
            '-1632637887',
            '-1944416051',
            '-1003983013',
            '1332572420',
            '-685858657',
            '1881619893',
            '-1302312327',
            '-166220484',
            '-140844228',
            '1341040064',
            '1331793398',
            '630655710',
            '-927817238',
            '-1234598652',
            '2035252677',
            '-841275299',
            '1805939844',
            '-1262185129',
            '-1300287140',
            '1145296522',
            '-1801876110',
            '-695682773',
            '-1662499594',
            '1587594519',
            '-980788064',
            '-422648769',
            '1669408777',
            '-905224327',
            '333178647',
            '937078842',
            '-27675015',
            '-1672376614',
            '-362229245',
            '1126901876',
            '-849224786',
            '584049013',
            '-344480469',
            '86165285',
            '239631990',
            '-1954104742',
            '-1761842391',
            '201424638',
            '237611760',
            '-716225989',
            '949992151',
            '1203164112',
            '-840691575',
            '954492103',
            '-1869596305',
            '2017045570',
            '-375208940',
            '-1665773631',
            '830091838',
            '1665018314',
            '-2031683539',
            '-169801033',
            '-974736656',
            '-1786221445',
            '892413121',
            '-1112577243',
            '794011186',
            '2048010729',
            '-252275063',
            '-1439802875',
            '-281230722',
            '-1170247802',
            '-154752033',
            '1530378009',
            '1491975454',
            '989291042',
            '1662484922',
            '1590714628',
            '1801974543',
            '484301207',
            '937478167',
            '437076463',
            '-80361234',
            '-221175104',
            '727024065',
            '215718682',
            '-733970054',
            '-843610408',
            '187075164',
            '-820943320',
            '-1577189914',
            '2101786978',
            '-1932695',
            '1100409293',
            '1463116691',
            '1363630072',
            '1205027705',
            '-1874067329',
            '-91925097',
            '145640643',
            '-1970892244',
            '600220098',
            '1504197258',
            '394768857',
            '-1781249072',
            '-1116648262',
            '-959309010',
            '-1793700997',
            '1989635730',
            '361633729',
            '567086176',
            '427370484',
            '-1031065667',
            '-820364866',
            '1841144357',
            '-1938163870',
            '760028070',
            '499719809',
            '-2097607039',
            '-1000455876',
            '1494663719',
            '1743071636',
            '150436195',
            '1831422022',
            '-1827594089',
            '-1271236567',
            '-2103025036',
            '162572905',
            '1789997679',
            '-915295405',
            '-1741787485',
            '-320902371',
            '-1468325011',
            '1458496679',
            '182589188',
            '-1981999293',
            '-1866074883',
            '-1791412542',
            '-1470895453',
            '-300943020',
            '422831665',
            '1426260374',
            '-812722655',
            '-1397864045',
            '623732224',
            '1903400336',
            '2135498269',
            '1861156859',
            '345476446',
            '-389942627',
            '-698603461',
            '1387808740',
            '57619177',
            '-601270010',
            '-322130445',
            '1386393730',
            '1280076658',
            '-58704212',
            '864548795',
            '929829147',
            '-1896766028',
            '-543062471',
            '1015312902',
            '639537043',
            '-1417848885',
            '669828979',
            '1435086068',
            '-1620087907',
            '1816525178',
            '1278110908',
            '1806514892',
            '-839370398',
            '-1136094886',
            '1095944476',
            '-1788696556',
            '498970127',
            '996567341',
            '-1310613771',
            '-1759066200',
            '-1108501941',
            '1135426798',
            '1313019764',
            '-525807559',
            '74115714',
            '-981797598',
            '-662483233',
            '1442739529',
            '1744407024',
            '977789622',
            '-25291464',
            '351827806',
            '804041190',
            '-1294652107',
            '-287608762',
            '675163773',
            '-637280409',
            '-761965556',
            '-98570751',
            '827308436',
            '412661525',
            '423609758',
            '688259390',
            '-1217569218',
            '-512289164',
            '-2126157655',
            '-1146782153',
            '-1639818042',
            '1661525910',
            '-544549555',
            '-711853343',
            '1552741875',
            '1317073451',
            '-208295391',
            '-140118619',
            '-337804942',
            '1591210960',
            '1727735870',
            '1434967563',
            '-292231563',
            '418702718',
            '-794410438',
            '764450292',
            '-843764900',
            '-807947870',
            '-1586049269',
            '-441174156',
            '1899880066',
            '-81557970',
            '1250841004',
            '-810937327',
            '1136889246',
            '-1112137387',
            '-209751772',
            '2061785608',
            '-1539766767',
            '-175707202',
            '630310527',
            '-1730933550',
            '-2079065419',
            '-999635056',
            '1402091479',
            '-39703812',
            '1237284125',
            '-933022568',
            '-955605606',
            '2012400226',
            '1376678783',
            '-469146920',
            '-688517011',
            '1972825957',
            '-142522180',
            '-902834649',
            '1160372001',
            '-463286112',
            '129203860',
            '-1107189542',
            '-121816191',
            '-1137982786',
            '1186501020',
            '556770366',
            '1044853036',
            '-561650466',
            '-1983331601',
            '1085537661',
            '-543226964',
            '-1059594729',
            '1431158197',
            '-2060986350',
            '2106888843',
            '1235759363',
            '525979908',
            '-151363504',
            '-741098835',
            '-577936321',
            '-478850034',
            '1943246105',
            '1619200854',
            '1353573328',
            '1527479844',
            '-553524908',
            '-686128146',
            '1860361227',
            '1399684728',
            '1037110058',
            '-450019822',
            '-1991001089',
            '-713633972',
            '110791319',
            '-731196686',
            '2047785591',
            '742457488',
            '-31073229',
            '-1268345119',
            '1555059795',
            '-1488049059',
            '-80388583',
            '1167645098',
            '-1598197334',
            '1762618587',
            '1728530915',
            '1991744139',
            '-1862102383',
            '-1419366125',
            '-710260965',
            '-1231901284',
            '1292144200',
            '-486980301',
            '-1116928334',
            '665187582',
            '-2058167188',
            '-685182821',
            '411630641',
            '-1599286631',
            '-1360905999',
            '-1765441407',
            '-1367371946',
            '-1366151175',
            '-1908076130',
            '-1216101553',
            '363014621',
            '-886976380',
            '796075024',
            '-1905446284',
            '1240507096',
            '-1645774597',
            '907418780',
            '337499434',
            '-1033850919',
            '1316044777',
            '-1284503755',
            '-1170343297',
            '-1723677238',
            '1452615836',
            '699240992',
            '-1012530464',
            '-1336470978',
            '1053072621',
            '-649858845',
            '-1199876470',
            '-478031840',
            '257229353',
            '1864807743',
            '-1155688805',
            '-445561206',
            '-1843927426',
            '432261569',
            '2087268304',
            '-230853697',
            '-1950259485',
            '-843219601',
            '294084915',
            '-266255631',
            '-1419602688',
            '1593165767',
            '1271740107',
            '-2095191140',
            '1841589609',
            '-255384519',
            '1298059031',
            '1555929558',
            '-63437323',
            '651357530',
            '-2000396415',
            '1833579466',
            '-1427081347',
            '2054002980',
            '698116095',
            '-352419712',
            '-1741885998',
            '-1383698163',
            '372650798',
            '-224594767',
            '-604168241',
            '425510525',
            '-1269186335',
            '1790626629',
            '208288758',
            '1673891282',
            '1754800592',
            '1096799376',
            '371009167',
            '-1964190936',
            '-1159382418',
            '-1339364969',
            '506529789',
            '648826889',
            '-308240949',
            '-1734666889',
            '1925169869',
            '-812300053',
            '706571765',
            '1784285672',
            '-589913697',
            '1882299555',
            '1105945760',
            '-745002354',
            '14529533',
            '1434329978',
            '1962552705',
            '-786130360',
            '1390958736',
            '-458198651',
            '223448996',
            '-440484427',
            '916360262',
            '238437097',
            '2046850065',
            '196732922',
            '1486264046',
            '-1154762966',
            '-740502603',
            '1082754410',
            '-190004975',
            '340763992',
            '-2126035736',
            '1064491667',
            '1069933158',
            '162523793',
            '1495749722',
            '-2014570441',
            '-1533506556',
            '1126365302',
            '-1542700085',
            '1709966440',
            '-1684234659',
            '124002824',
            '-1858926850',
            '-410858321',
            '347337205',
            '-362122644',
            '1766374626',
            '-771920975',
            '-963157353',
            '715938352',
            '-2121998551',
            '656916509',
            '-1601886178',
            '-2101165219',
            '567025219',
            '278561081',
            '-608798655',
            '1757113382',
            '417533668',
            '297025180',
            '490535071',
            '-1994061258',
            '31786483',
            '1567958819',
            '-1797417861',
            '-159820257',
            '2074872260',
            '27190163',
            '468446959',
            '1668649859',
            '1401111363',
            '656788638',
            '-1036292584',
            '-1910450713',
            '1322401351',
            '78276595',
            '1841050326',
            '-820710516',
            '-606773997',
            '-22476922',
            '724840600',
            '-769701020',
            '-2011657772',
            '1641969781',
            '-2019242212',
            '1444213091',
            '1452796197',
            '117632397',
            '680657090',
            '843431394',
            '1482432457',
            '-1989644090',
            '-879276966',
            '-1251077561',
            '-2055176614',
            '106729085',
            '-405869473',
            '395565763',
            '1576095432',
            '-389345654',
            '1437948085',
            '1352795172',
            '792402868',
            '1052140588',
            '-1049963555',
            '-977204337',
            '-2069128143',
            '1242064626',
            '1350795482',
            '-823930965',
            '1075431311',
            '-1761070985',
            '-19218529',
            '347100326',
            '-701838528',
            '132694789',
            '2040769167',
            '-837716019',
            '-2083592417',
            '-796301991',
            '1598237633',
            '517739503',
            '472283023',
            '9823824',
            '-1412412107',
            '-142840898',
            '-1376053706',
            '713611166',
            '-483926277',
            '-1851277204',
            '-1080858675',
            '-96358360',
            '2081337751',
            '1028939426',
            '-580241560',
            '198311860',
            '1810920409',
            '-2013077083',
            '1554041693',
            '451719128',
            '-800264600',
            '1120873990',
            '-477692328',
            '1885462895',
            '1777322625',
            '-588376846',
            '-1077769589',
            '1437835264',
            '595738177',
            '172790022',
            '-176712036',
            '377010603',
            '-1284517867',
            '1682554390',
            '-2036781213',
            '-322610354',
            '-1880362825',
            '1363236595',
            '1424815570',
            '1529909300',
            '-1974149916',
            '854349371',
            '-1763760726',
            '862612318',
            '-616595242',
            '-784085878',
            '1197020413',
            '-207616261',
            '1149016506',
            '-477011168',
            '1985759733',
            '576183274',
            '-2107833653',
            '-1357989585',
            '-512226108',
            '-2886370',
            '-415723808',
            '-1970668072',
            '-1763613602',
            '979855965',
            '-1264870166',
            '1297427252',
            '1858071094',
            '-169050634',
            '382622598',
            '2057673277',
            '1631970555',
            '-884413619',
            '-1309178769',
            '1578741585',
            '785806004',
            '215753292',
            '1046284439',
            '1584728728',
            '1843296998',
            '-863436006',
            '846582238',
            '-505510469',
            '-1487586046',
            '-760296088',
            '1210762017',
            '654857360',
            '-418402145',
            '277103569',
            '70549657',
            '-1541404636',
            '-2109944552',
            '-2023362876',
            '-305906178',
            '1736210026',
            '609232781',
            '-1734381611',
            '1217964213',
            '-1313989688',
            '-1063695776',
            '-408399784',
            '-101023009',
            '14744242',
            '-173257278',
            '-1467106080',
            '255354114',
            '576397502',
            '1274991050',
            '1255818424',
            '-678398555',
            '-1630125386',
            '1462474231',
            '709526817',
            '750095058',
            '363031735',
            '1973654809',
            '-484851058',
            '-1480468082',
            '1934161052',
            '-2101303758',
            '-626972865',
            '-996666867',
            '-1097719196',
            '-714452980',
            '-1096658022',
            '-2008549329',
            '21023462',
            '1841074698',
            '285574872',
            '-231344931',
            '1023506520',
            '-1363140598',
            '-652966123',
            '-2063062499',
            '92776169',
            '1390239026',
            '-1131681592',
            '1854884350',
            '-722252515',
            '1571790389',
            '-1888725548',
            '-949855159',
            '-632232153',
            '-612318795',
            '2118867464',
            '1791993909',
            '1382262646',
            '615049775',
            '1892976300',
            '-277293624',
            '1038690453',
            '1418347542',
            '-1557893565',
            '649234727',
            '-660905928',
            '-972699885',
            '-1302339532',
            '-935610500',
            '1408053350',
            '583278677',
            '351738391',
            '-1139674538',
            '-1338204398',
            '933934599',
            '-280009985',
            '1984383404',
            '1290315974',
            '-504282460',
            '-391274108',
            '1736423373',
            '-1545557995',
            '1452403842',
            '-814265778',
            '-832868143',
            '276328322',
            '-1468769399',
            '-2043793207',
            '-2016373310',
            '-1853976323',
            '-998116448',
            '1808439708',
            '-208860286',
            '-1170221249',
            '-1542662284',
            '-2096166325',
            '-1546874321',
            '-1028812622',
            '-1969146499',
            '63806286',
            '-738087501',
            '877883664',
            '576078815',
            '1679350266',
            '111683591',
            '850075291',
            '-971805123',
            '534077208',
            '-65225388',
            '1983469265',
            '-1712788362',
            '1571874959',
            '-808551079',
            '-848723031',
            '-2038776855',
            '-526089423',
            '-2062041771',
            '1874573222',
            '931113',
            '-2054784942',
            '1534637158',
            '-789243257',
            '1844902369',
            '-1221958302',
            '-2142164755',
            '-311183630',
            '772126004',
            '1405663982',
            '-924437762',
            '1097138758',
            '-815625436',
            '1446555495',
            '494311969',
            '299696233',
            '1067130970',
            '-590903121',
            '-2013964273',
            '1706148796',
            '-72009169',
            '-936596561',
            '-1073455856',
            '-2117831561',
            '70437560',
            '2067407085',
            '40049648',
            '336243079',
            '1711882789',
            '-1702663511',
            '-1970039176',
            '-512766390',
            '-536118700',
            '1328953434',
            '1467831850',
            '639603896',
            '-718765565',
            '650139790',
            '-21643890',
            '-1137896450',
            '558708716',
            '365374406',
            '1739918878',
            '1947279903',
            '173527685',
            '-1399642801',
            '-702289768',
            '-505527128',
            '1821739140',
            '-1322506768',
            '-6768910',
            '-1528843666',
            '-1149435275',
            '-742456300',
            '1901079875',
            '979229214',
            '2116675943',
            '953899715',
            '1951661469',
            '2103762030',
            '-1355380193',
            '-1413736769',
            '48864570',
            '248069453',
            '-72125285',
            '-1557158547',
            '-1483090057',
            '113497513',
            '-1796062286',
            '-1074101645',
            '1101444132',
            '-417917969',
            '-1723707803',
            '23566665',
            '99760235',
            '313533062',
            '1808081167',
            '864633966',
            '-470958847',
            '1984490109',
            '-472390404',
            '-608937137',
            '-2098081998',
            '-930574569',
            '-838600314',
            '1961427134',
            '722894932',
            '406655906',
            '-1686462825',
            '-215550656',
            '1318081180',
            '-893680752',
            '902286513',
            '1408026914',
            '-191439840',
            '-2137007266',
            '157322217',
            '1703129930',
            '-97546934',
            '879371267',
            '-158760887',
            '1332007036',
            '841173219',
            '1781645066',
            '-257030695',
            '-1740348345',
            '-1050495450',
            '683759019',
            '-1240475969',
            '932740194',
            '-1566844186',
            '-164885365',
          ],
          one: '420217769',
          two: '1243744842',
        },
        webgl: {
          supportedExtensions: [
            'ANGLE_instanced_arrays',
            'EXT_blend_minmax',
            'EXT_color_buffer_half_float',
            'EXT_disjoint_timer_query',
            'EXT_float_blend',
            'EXT_frag_depth',
            'EXT_shader_texture_lod',
            'EXT_texture_compression_bptc',
            'EXT_texture_compression_rgtc',
            'EXT_texture_filter_anisotropic',
            'WEBKIT_EXT_texture_filter_anisotropic',
            'EXT_sRGB',
            'KHR_parallel_shader_compile',
            'OES_element_index_uint',
            'OES_fbo_render_mipmap',
            'OES_standard_derivatives',
            'OES_texture_float',
            'OES_texture_float_linear',
            'OES_texture_half_float',
            'OES_texture_half_float_linear',
            'OES_vertex_array_object',
            'WEBGL_color_buffer_float',
            'WEBGL_compressed_texture_s3tc',
            'WEBKIT_WEBGL_compressed_texture_s3tc',
            'WEBGL_compressed_texture_s3tc_srgb',
            'WEBGL_debug_renderer_info',
            'WEBGL_debug_shaders',
            'WEBGL_depth_texture',
            'WEBKIT_WEBGL_depth_texture',
            'WEBGL_draw_buffers',
            'WEBGL_lose_context',
            'WEBKIT_WEBGL_lose_context',
            'WEBGL_multi_draw',
          ],
          vendor: 'Google Inc. (NVIDIA)',
          renderer:
            'ANGLE (NVIDIA, NVIDIA GeForce RTX 2070 SUPER Direct3D11 vs_5_0 ps_5_0, D3D11-27.21.14.5671)',
        },
        fonts: [
          { name: 'Monospace', width: 1161, height: 225 },
          { name: 'Wingdings 2', width: 1161, height: 225 },
          { name: 'ITC Bodoni 72 Bold', width: 1161, height: 225 },
          { name: 'Menlo', width: 1355, height: 213 },
          { name: 'Gill Sans MT', width: 1355, height: 213 },
          { name: 'Lucida Sans', width: 1355, height: 213 },
          { name: 'Bodoni 72', width: 1355, height: 213 },
          { name: 'Serif', width: 1355, height: 213 },
          { name: 'Shree Devanagari 714', width: 1355, height: 213 },
          { name: 'Microsoft Tai Le', width: 1463, height: 244 },
          { name: 'Nimbus Roman No 9 L', width: 1463, height: 244 },
          { name: 'Candara', width: 1388, height: 235 },
          { name: 'Press Start 2P', width: 1388, height: 235 },
          { name: 'Waseem', width: 1355, height: 213 },
        ],
        mr: [
          { name: 'Math.abs', result: 20 },
          { name: 'Math.acos', result: 40 },
          { name: 'Math.asin', result: 40 },
          { name: 'Math.atanh', result: 40 },
          { name: 'Math.cbrt', result: 20 },
          { name: 'Math.exp', result: 20 },
          { name: 'Math.random', result: 20 },
          { name: 'Math.round', result: 0 },
          { name: 'Math.sqrt', result: 20 },
          { name: 'isFinite', result: 0 },
          { name: 'isNaN', result: 0 },
          { name: 'parseFloat', result: 0 },
          { name: 'parseInt', result: 20 },
          { name: 'JSON.parse', result: 120 },
        ],
        window: {
          document: {
            documentMode: 'undefined',
            webdriver: false,
            driver: false,
            selenium: false,
            hidden: true,
            webkitHidden: true,
            getComputedStyle: 'function',
            $chrome_asyncScriptInfo: false,
          },
          navigator: {
            plugins: [
              {
                name: 'Chrome PDF Plugin',
                description: 'Portable Document Format',
                filename: 'internal-pdf-viewer',
                mimeTypes: [
                  {
                    type: 'application/x-google-chrome-pdf',
                    description: 'Portable Document Format',
                    suffixes: 'pdf',
                  },
                ],
              },
              {
                name: 'Chrome PDF Viewer',
                description: '',
                filename: 'mhjfbmdgcfjbbpaeojofohoefgiehjai',
                mimeTypes: [{ type: 'application/pdf', description: '', suffixes: 'pdf' }],
              },
              {
                name: 'Native Client',
                description: '',
                filename: 'internal-nacl-plugin',
                mimeTypes: [
                  {
                    type: 'application/x-nacl',
                    description: 'Native Client Executable',
                    suffixes: '',
                  },
                  {
                    type: 'application/x-pnacl',
                    description: 'Portable Native Client Executable',
                    suffixes: '',
                  },
                ],
              },
            ],
            mimeTypes: [
              { type: 'application/pdf', description: '', suffixes: 'pdf' },
              {
                type: 'application/x-google-chrome-pdf',
                description: 'Portable Document Format',
                suffixes: 'pdf',
              },
              { type: 'application/x-nacl', description: 'Native Client Executable', suffixes: '' },
              {
                type: 'application/x-pnacl',
                description: 'Portable Native Client Executable',
                suffixes: '',
              },
            ],
            languages: ['en-US', 'en'],
            language: 'en-US',
            appName: 'Netscape',
            appCodeName: 'Mozilla',
            userAgent:
              'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36',
            productSub: '20030107',
            product: 'Gecko',
            onLine: true,
            vibrate: 'function',
            getBattery: 'function',
            credentials: true,
            appMinorVersion: false,
            bluetooth: true,
            storage: true,
            getGamepads: true,
            getStorageUpdates: false,
            hardwareConcurrency: true,
            mediaDevices: true,
            mozAlarms: false,
            mozConnection: false,
            mozIsLocallyAvailable: false,
            mozPhoneNumberService: false,
            msManipulationViewsEnabled: false,
            permissions: {
              enabled: true,
              checks: [
                { success: true, name: 'geolocation', result: 'prompt' },
                { success: true, name: 'notifications', result: 'prompt' },
                {
                  success: false,
                  name: 'push',
                  result:
                    "NotSupportedError: Failed to execute 'query' on 'Permissions': Push Permission without userVisibleOnly:true isn't supported yet.",
                },
                { success: true, name: 'midi', result: 'granted' },
                { success: true, name: 'camera', result: 'prompt' },
                { success: true, name: 'microphone', result: 'prompt' },
                {
                  success: false,
                  name: 'speaker',
                  result:
                    "TypeError: Failed to execute 'query' on 'Permissions': The provided value 'speaker' is not a valid enum value of type PermissionName.",
                },
                {
                  success: false,
                  name: 'device-info',
                  result:
                    "TypeError: Failed to execute 'query' on 'Permissions': The provided value 'device-info' is not a valid enum value of type PermissionName.",
                },
                { success: true, name: 'background-sync', result: 'granted' },
                {
                  success: false,
                  name: 'bluetooth',
                  result:
                    "TypeError: Failed to execute 'query' on 'Permissions': The provided value 'bluetooth' is not a valid enum value of type PermissionName.",
                },
                { success: true, name: 'persistent-storage', result: 'prompt' },
                {
                  success: false,
                  name: 'ambient-light-sensor',
                  result:
                    "TypeError: Failed to execute 'query' on 'Permissions': GenericSensorExtraClasses flag is not enabled.",
                },
                { success: true, name: 'accelerometer', result: 'granted' },
                { success: true, name: 'gyroscope', result: 'granted' },
                { success: true, name: 'magnetometer', result: 'granted' },
                {
                  success: false,
                  name: 'clipboard',
                  result:
                    "TypeError: Failed to execute 'query' on 'Permissions': The provided value 'clipboard' is not a valid enum value of type PermissionName.",
                },
                {
                  success: false,
                  name: 'accessibility-events',
                  result:
                    "TypeError: Failed to execute 'query' on 'Permissions': Accessibility Object Model is not enabled.",
                },
                { success: true, name: 'clipboard-read', result: 'prompt' },
                { success: true, name: 'clipboard-write', result: 'granted' },
                { success: true, name: 'payment-handler', result: 'granted' },
              ],
            },
            registerProtocolHandler: true,
            requestMediaKeySystemAccess: true,
            requestWakeLock: false,
            sendBeacon: true,
            serviceWorker: true,
            storeWebWideTrackingException: false,
            webkitGetGamepads: false,
            webkitTemporaryStorage: true,
            webdriver: false,
            cookieEnabled: true,
            javaEnabled: false,
            doNotTrack: -1,
            geolocation: {},
            brave: -1,
            appVersion:
              '5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36',
          },
          screen: {
            availWidth: 1920,
            availHeight: 1040,
            width: 1920,
            height: 1080,
            colorDepth: 24,
            pixelDepth: 24,
          },
          innerWidth: 1920,
          innerHeight: 937,
          outerWidth: 1920,
          outerHeight: 1040,
          pageXOffset: 0,
          pageYOffset: 0,
          screenX: 1920,
          screenY: 3,
          addEventListener: true,
          XMLHttpRequest: true,
          XDomainRequest: false,
          emit: false,
          DeviceOrientationEvent: true,
          DeviceMotionEvent: true,
          TouchEvent: true,
          spawn: false,
          chrome: true,
          chromeWebStore: false,
          functionPrototypeBind: true,
          Buffer: false,
          PointerEvent: true,
          _phantom: false,
          webdriver: false,
          domAutomation: false,
          callPhantom: false,
          returnCCon: false,
          opera: false,
          InstallTrigger: 'undefined',
          HTMLElement: false,
          mozInnerScreenY: false,
          ArrayprototypeforEach: true,
          FileReader: true,
          ActiveXObject: false,
          RTCPeerConnection: 'function',
          mozRTCPeerConnection: 'undefined',
          webkitRTCPeerConnection: 'function',
          imul: true,
          parseInt: true,
          hypot: true,
          sessionStorage: true,
          localStorage: true,
          indexedDB: true,
          timezoneOffset: 240,
          $cdc_asdjflasutopfhvcZLmcfl_: false,
          XPathResult: true,
          EventSource: 'function',
          devicePixelRatio: 1,
          speechSynthesis: [
            { voiceURI: 'Microsoft David - English (United States)', lang: 'en-US' },
            { voiceURI: 'Microsoft Mark - English (United States)', lang: 'en-US' },
            { voiceURI: 'Microsoft Zira - English (United States)', lang: 'en-US' },
            { voiceURI: 'Google Deutsch', lang: 'de-DE' },
            { voiceURI: 'Google US English', lang: 'en-US' },
            { voiceURI: 'Google UK English Female', lang: 'en-GB' },
            { voiceURI: 'Google UK English Male', lang: 'en-GB' },
            { voiceURI: 'Google español', lang: 'es-ES' },
            { voiceURI: 'Google español de Estados Unidos', lang: 'es-US' },
            { voiceURI: 'Google français', lang: 'fr-FR' },
            { voiceURI: 'Google हिन्दी', lang: 'hi-IN' },
            { voiceURI: 'Google Bahasa Indonesia', lang: 'id-ID' },
            { voiceURI: 'Google italiano', lang: 'it-IT' },
            { voiceURI: 'Google 日本語', lang: 'ja-JP' },
            { voiceURI: 'Google 한국의', lang: 'ko-KR' },
            { voiceURI: 'Google Nederlands', lang: 'nl-NL' },
            { voiceURI: 'Google polski', lang: 'pl-PL' },
            { voiceURI: 'Google português do Brasil', lang: 'pt-BR' },
            { voiceURI: 'Google русский', lang: 'ru-RU' },
            { voiceURI: 'Google 普通话（中国大陆）', lang: 'zh-CN' },
            { voiceURI: 'Google 粤語（香港）', lang: 'zh-HK' },
            { voiceURI: 'Google 國語（臺灣）', lang: 'zh-TW' },
          ],
          __nightmare: false,
          cdc_adoQpoasnfa76pfcZLmcfl_Array: false,
          cdc_adoQpoasnfa76pfcZLmcfl_Promise: false,
          cdc_adoQpoasnfa76pfcZLmcfl_Symbol: false,
          OSMJIF: false,
          _Selenium_IDE_Recorder: false,
          __$webdriverAsyncExecutor: false,
          __driver_evaluate: false,
          __driver_unwrapped: false,
          __fxdriver_evaluate: false,
          __fxdriver_unwrapped: false,
          __lastWatirAlert: false,
          __lastWatirConfirm: false,
          __lastWatirPrompt: false,
          __phantomas: false,
          __selenium_evaluate: false,
          __selenium_unwrapped: false,
          __webdriverFuncgeb: false,
          __webdriver__chr: false,
          __webdriver_evaluate: false,
          __webdriver_script_fn: false,
          __webdriver_script_func: false,
          __webdriver_script_function: false,
          __webdriver_unwrapped: false,
          awesomium: false,
          callSelenium: false,
          calledPhantom: false,
          calledSelenium: false,
          domAutomationController: false,
          watinExpressionError: false,
          watinExpressionResult: false,
          spynner_additional_js_loaded: false,
          fmget_targets: false,
          geb: false,
        },
        pixel: {
          canvas: { one: 'b6655ad93c158463bd034b774b98b4634d58892e' },
          shockwave: false,
          silverlight: false,
          browser: 'Chrome',
          internet: false,
          acrobat: false,
          javascript: '1.7',
          apng: true,
          battery: {
            charging: true,
            chargingTime: 0,
            dischargingTime: 'Infinity',
            level: 1,
            onchargingchange: null,
            onchargingtimechange: null,
            ondischargingtimechange: null,
            onlevelchange: null,
          },
          fonts: [3, 4, 5, 6, 7, 9, 12, 13, 43, 52, 53, 54, 60, 61, 62, 63, 64, 65],
          window: {
            document: {
              querySelector: 'tr_true',
              getElementsByClassName: 'tr_true',
              images: 'tr_true',
              compatMode: 'CSS1Compat',
              documentMode: 'tr_false',
              all: true,
              documentElementContextMenu: 'tr_false',
            },
            navigator: {
              userAgent:
                'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36',
              appName: 'Netscape',
              appCodeName: 'Mozilla',
              appVersion:
                '5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36',
              appMinorVersion: 'tr_false',
              product: 'Gecko',
              productSub: '20030107',
              vendor: 'Google Inc.',
              vendorSub: '',
              buildID: 'tr_false',
              oscpu: 'tr_false',
              platform: 'Win32',
              hardwareConcurrency: 16,
              language: 'en-US',
              languages: ['en-US', 'en'],
              systemLanguage: 'tr_false',
              userLanguage: 'tr_false',
              doNotTrack: null,
              msDoNotTrack: 'tr_false',
              cookieEnabled: true,
              geolocation: 'tr_true',
              vibrate: 'tr_true',
              maxTouchPoints: 0,
            },
            XDomainRequest: 'tr_false',
            createPopup: 'tr_false',
            removeEventListener: 'tr_true',
            globalStorage: 'tr_false',
            openDatabase: 'tr_true',
            indexedDB: 'tr_true',
            attachEvent: 'tr_false',
            ActiveXObject: 'tr_false',
            dispatchEvent: 'tr_true',
            addBehavior: 'tr_false',
            addEventListener: 'tr_true',
            detachEvent: 'tr_false',
            fireEvent: 'tr_false',
            MutationObserver: 'tr_true',
            HTMLMenuItemElement: 'tr_false',
            Int8Array: 'tr_true',
            postMessage: 'tr_true',
            querySelector: 'tr_false',
            performanceNow: 'tr_true',
            chrome: {
              app: {
                isInstalled: false,
                InstallState: {
                  DISABLED: 'disabled',
                  INSTALLED: 'installed',
                  NOT_INSTALLED: 'not_installed',
                },
                RunningState: {
                  CANNOT_RUN: 'cannot_run',
                  READY_TO_RUN: 'ready_to_run',
                  RUNNING: 'running',
                },
              },
            },
          },
        },
      })
    : require('db').GetRandomFingerprint
const AES_ENCRYPTION_KEY =
  process.argv[2] === 'staging' ? 'staging' : process.env.CAPSULEAIO_NOKAMAI_AES_ENCRYPTION_KEY

/**s
 * Initial Fingerprint class, used to retrieve an encrypted fingerprint and user agent for use in task prior to generating pixel or nokaami
 *
 * This is very useful for sites with queues, as the user agent prior to the queue gets bound to the user agent which passed the queue
 * Which causes nokamai or pixel to generate prior to queue, or use the same fingerprint to many tasks by passing a fingerprint in bot to nokamai and pixel
 * Instead, use the InitialFingerprint websocket request to grab parameters and a user agent on initialization of task, to be used throughout the task
 */
class InitialFingerprint {
  encryptParameters(parameters) {
    try {
      const encrypted = encrypt(JSON.stringify(parameters), AES_ENCRYPTION_KEY)
      return encrypted
    } catch (err) {
      return null
    }
  }

  generateParameters() {
    return new Promise(async (resolve, reject) => {
      try {
        const fingerprint = await GetRandomFingerprint()

        return resolve({
          success: true,
          user_agent: fingerprint.window.navigator.userAgent,
          parameters: this.encryptParameters({
            fingerprint,
          }),
        })
      } catch (err) {
        return reject(err)
      }
    })
  }

  handleGeneration() {
    return new Promise(async (resolve, reject) => {
      try {
        const parameters = await this.generateParameters()
        return resolve(parameters)
      } catch (err) {
        return reject(err)
      }
    })
  }
}

module.exports = InitialFingerprint
